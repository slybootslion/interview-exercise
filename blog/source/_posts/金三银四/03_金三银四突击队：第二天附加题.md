---
title: "金三银四突击队：第二天附加题"
date: 2021-02-24 08:37:03
tags:
  - 面试
  - 金三银四
---

<!--banner-pic|sticker|content-img|content-img-half-->
<img class="banner-pic" src="http://oss.slybootslion.com/blog/IMG_0150.jpg?x-oss-process=image/auto-orient,1/quality,q_80/watermark,text_c2x5Ym9vdHNsaW9u,color_ffffff,size_40,shadow_70,t_74,x_10,y_10"/>

### 第一题

> 什么是回调？回调使用中存在什么问题？

将一个函数，当作参数放到另一个函数中在恰当的时机（满足条件，或者触发时）被执行，这个被执行的函数就叫回调函数。
回调函数可以是同步，也被作为处理异步的方式。

回调函数存在的问题：
回调函数剥夺了return的权利，回调函数没有返回值，或者说回调函数的返回值没有意义，如果想要进一步进行操作，只能在回调函数中进行操作。
如果要操作的步骤过多，就会形成回调函数套回调函数的情况，因为嵌套过多而造成代码难以阅读和维护，就是俗称的回调地狱。

### 第二题

> Promise.allSettled了解吗？手动实现一下Promise.allSettled？

Promise.allSettled()方法返回一个在所有给定的promise都已经fulfilled或rejected后的promise，并带有一个对象数组，每个对象表示对应的promise结果。
Promise.allSettled将所有的promise结果返回，无论是否有失败的结果，而Promise.all会返回所有成功的结果，如果有一个失败，只返回失败的结果。

```js
Promise.myAllSettled = function(arr) {
  return new Promise((resolve, reject) => {
    const res = []
    if (!arr.length) return resolve(res)
    let count = 0
    for(let i = 0; i < arr.legnth; i++) {
      if(!arr[i] instenceof Promise) {
        res[i] = arr[i]
        if (++count === arr.length) resolve(res)
      } else {
        arr[i].then(result => {
          res[i] = result
          if (++count === arr.length) resolve(res)
        }, err => {
          res[i] = err
          if (++count === arr.length) resolve(res)
        })
      }
    }
  })
}
```
